%%sql
select product_code as codigo ,product_name as nombre ,count(product_id) as cantidad
from orders as o inner join order_details as od on o.id=od.id left join products as pro on od.product_id = pro.id
where YEAR(o.order_date)=2006
group by od.product_id
having count(od.product_id)>=3


%%sql
data = pd.read_sql_query("select product_code as codigo ,product_name as nombre,
count(product_id) as cantidad from orders as o 
inner join order_details as od on o.id=od.id 
left join products as pro on od.product_id = pro.id where YEAR(o.order_date)=2006 
group by od.product_id having count(od.product_id)>=3", engine)
data